var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,
278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,
271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,
23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];
function stackBlurImage(d,b,h,k){var d=document.getElementById(d),e=d.naturalWidth,m=d.naturalHeight,u=document.getElementById(b);u.style.width=e+"px";u.style.height=m+"px";u.width=e;u.height=m;u=u.getContext("2d");u.clearRect(0,0,e,m);u.drawImage(d,0,0);isNaN(h)||h<1||(k?stackBlurCanvasRGBA(b,0,0,e,m,h):stackBlurCanvasRGB(b,0,0,e,m,h))}
function stackBlurCanvasRGBA(d,b,h,k,e,m){if(!(isNaN(m)||m<1)){m|=0;var d=d.getContext("2d"),u;try{try{u=d.getImageData(b,h,k,e)}catch(z){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),u=d.getImageData(b,h,k,e)}catch(o){throw alert("Cannot access local image"),Error("unable to access local image data: "+o);}}}catch(E){throw alert("Cannot access image"),Error("unable to access image data: "+E);}var j=u.data,r,v,f,p,l,S,w,g,A,F,L,I,K,J,H,B,C,G,D,N,O,s,P;r=m+m+1;var T=
k-1,t=e-1,M=m+1,Q=M*(M+1)/2,R=new BlurStack,q=R;for(f=1;f<r;f++)if(q=q.next=new BlurStack,f==M)var W=q;q.next=R;q=f=null;S=l=0;var U=mul_table[m],V=shg_table[m];for(v=0;v<e;v++){H=B=C=G=w=g=A=F=0;L=M*(D=j[l]);I=M*(N=j[l+1]);K=M*(O=j[l+2]);J=M*(s=j[l+3]);w+=Q*D;g+=Q*N;A+=Q*O;F+=Q*s;q=R;for(f=0;f<M;f++)q.r=D,q.g=N,q.b=O,q.a=s,q=q.next;for(f=1;f<M;f++)p=l+((T<f?T:f)<<2),w+=(q.r=D=j[p])*(P=M-f),g+=(q.g=N=j[p+1])*P,A+=(q.b=O=j[p+2])*P,F+=(q.a=s=j[p+3])*P,H+=D,B+=N,C+=O,G+=s,q=q.next;f=R;q=W;for(r=0;r<
k;r++)j[l+3]=s=F*U>>V,s!=0?(s=255/s,j[l]=(w*U>>V)*s,j[l+1]=(g*U>>V)*s,j[l+2]=(A*U>>V)*s):j[l]=j[l+1]=j[l+2]=0,w-=L,g-=I,A-=K,F-=J,L-=f.r,I-=f.g,K-=f.b,J-=f.a,p=S+((p=r+m+1)<T?p:T)<<2,H+=f.r=j[p],B+=f.g=j[p+1],C+=f.b=j[p+2],G+=f.a=j[p+3],w+=H,g+=B,A+=C,F+=G,f=f.next,L+=D=q.r,I+=N=q.g,K+=O=q.b,J+=s=q.a,H-=D,B-=N,C-=O,G-=s,q=q.next,l+=4;S+=k}for(r=0;r<k;r++){B=C=G=H=g=A=F=w=0;l=r<<2;L=M*(D=j[l]);I=M*(N=j[l+1]);K=M*(O=j[l+2]);J=M*(s=j[l+3]);w+=Q*D;g+=Q*N;A+=Q*O;F+=Q*s;q=R;for(f=0;f<M;f++)q.r=D,q.g=N,
q.b=O,q.a=s,q=q.next;p=k;for(f=1;f<=m;f++)l=p+r<<2,w+=(q.r=D=j[l])*(P=M-f),g+=(q.g=N=j[l+1])*P,A+=(q.b=O=j[l+2])*P,F+=(q.a=s=j[l+3])*P,H+=D,B+=N,C+=O,G+=s,q=q.next,f<t&&(p+=k);l=r;f=R;q=W;for(v=0;v<e;v++)p=l<<2,j[p+3]=s=F*U>>V,s>0?(s=255/s,j[p]=(w*U>>V)*s,j[p+1]=(g*U>>V)*s,j[p+2]=(A*U>>V)*s):j[p]=j[p+1]=j[p+2]=0,w-=L,g-=I,A-=K,F-=J,L-=f.r,I-=f.g,K-=f.b,J-=f.a,p=r+((p=v+M)<t?p:t)*k<<2,w+=H+=f.r=j[p],g+=B+=f.g=j[p+1],A+=C+=f.b=j[p+2],F+=G+=f.a=j[p+3],f=f.next,L+=D=q.r,I+=N=q.g,K+=O=q.b,J+=s=q.a,H-=
D,B-=N,C-=O,G-=s,q=q.next,l+=k}d.putImageData(u,b,h)}}
function stackBlurCanvasRGB(d,b,h,k,e,m){if(!(isNaN(m)||m<1)){m|=0;var d=d.getContext("2d"),u;try{try{u=d.getImageData(b,h,k,e)}catch(z){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),u=d.getImageData(b,h,k,e)}catch(o){throw alert("Cannot access local image"),Error("unable to access local image data: "+o);}}}catch(E){throw alert("Cannot access image"),Error("unable to access image data: "+E);}var j=u.data,r,v,f,p,l,S,w,g,A,F,L,I,K,J,H,B,C,G,D;r=m+m+1;var N=k-1,O=e-
1,s=m+1,P=s*(s+1)/2,T=new BlurStack,t=T;for(f=1;f<r;f++)if(t=t.next=new BlurStack,f==s)var M=t;t.next=T;t=f=null;S=l=0;var Q=mul_table[m],R=shg_table[m];for(v=0;v<e;v++){K=J=H=w=g=A=0;F=s*(B=j[l]);L=s*(C=j[l+1]);I=s*(G=j[l+2]);w+=P*B;g+=P*C;A+=P*G;t=T;for(f=0;f<s;f++)t.r=B,t.g=C,t.b=G,t=t.next;for(f=1;f<s;f++)p=l+((N<f?N:f)<<2),w+=(t.r=B=j[p])*(D=s-f),g+=(t.g=C=j[p+1])*D,A+=(t.b=G=j[p+2])*D,K+=B,J+=C,H+=G,t=t.next;f=T;t=M;for(r=0;r<k;r++)j[l]=w*Q>>R,j[l+1]=g*Q>>R,j[l+2]=A*Q>>R,w-=F,g-=L,A-=I,F-=f.r,
L-=f.g,I-=f.b,p=S+((p=r+m+1)<N?p:N)<<2,K+=f.r=j[p],J+=f.g=j[p+1],H+=f.b=j[p+2],w+=K,g+=J,A+=H,f=f.next,F+=B=t.r,L+=C=t.g,I+=G=t.b,K-=B,J-=C,H-=G,t=t.next,l+=4;S+=k}for(r=0;r<k;r++){J=H=K=g=A=w=0;l=r<<2;F=s*(B=j[l]);L=s*(C=j[l+1]);I=s*(G=j[l+2]);w+=P*B;g+=P*C;A+=P*G;t=T;for(f=0;f<s;f++)t.r=B,t.g=C,t.b=G,t=t.next;p=k;for(f=1;f<=m;f++)l=p+r<<2,w+=(t.r=B=j[l])*(D=s-f),g+=(t.g=C=j[l+1])*D,A+=(t.b=G=j[l+2])*D,K+=B,J+=C,H+=G,t=t.next,f<O&&(p+=k);l=r;f=T;t=M;for(v=0;v<e;v++)p=l<<2,j[p]=w*Q>>R,j[p+1]=g*Q>>
R,j[p+2]=A*Q>>R,w-=F,g-=L,A-=I,F-=f.r,L-=f.g,I-=f.b,p=r+((p=v+s)<O?p:O)*k<<2,w+=K+=f.r=j[p],g+=J+=f.g=j[p+1],A+=H+=f.b=j[p+2],f=f.next,F+=B=t.r,L+=C=t.g,I+=G=t.b,K-=B,J-=C,H-=G,t=t.next,l+=k}d.putImageData(u,b,h)}}function BlurStack(){this.a=this.b=this.g=this.r=0;this.next=null}
function progressBar(d){this.canvas=d;this.percent=0;this.updateProgress=progressBarUpdateProgress;this.redraw=progressBarRedraw;this.particles=[];this.newParticle=progressBarNewParticle;this.updateParticles=progressBarUpdateParticles;this.center_spin_frame=0;setTimeout(this.redraw(this.canvas,this.percent,this),20)}function progressBarUpdateProgress(d){if(d>this.percent)this.percent=d;if(this.percent>100)this.percent=100;if(this.percent<0)this.percent=0}
function progressBarRedraw(d,b,h){return function(){if(d.getContext){d.width=420;d.height=420;context=d.getContext("2d");context.strokeStyle="#555";context.lineWidth=4;context.beginPath();context.arc(200,200,100,0,Math.PI*2,!1);context.closePath();context.stroke();context.strokeStyle="#fff";context.lineWidth=2;context.shadowColor="#b4f5fd";context.shadowBlur=6;context.shadowOffsetX=0;context.shadowOffsetY=0;context.beginPath();context.arc(200,200,100,0,b/100*Math.PI*2,!1);context.stroke();context.save();
context.lineWidth=2;context.shadowBlur=0;context.beginPath();context.arc(200,200,30,0,Math.PI*2,!1);context.closePath();context.strokeStyle="#aaa";context.stroke();x=200+30*Math.cos(h.center_spin_frame/15*Math.PI*2);y=200+30*Math.sin(h.center_spin_frame/15*Math.PI*2);context.globalCompositeOperation="lighter";glow_gradient=context.createRadialGradient(x,y,0,x,y,15);glow_gradient.addColorStop(0,"rgba(255,255,255,.7)");glow_gradient.addColorStop(0.2,"rgba(180,245,255,.6)");glow_gradient.addColorStop(0.5,
"rgba(180,245,255,.2)");glow_gradient.addColorStop(1,"rgba(64,64,64,0)");context.fillStyle=glow_gradient;context.beginPath();context.arc(x,y,400,0,Math.PI*2,!1);context.closePath();context.fill();context.beginPath();context.arc(x,y,3,0,Math.PI*2,!1);context.closePath();context.fillStyle="#fff";context.fill();context.restore();x=200+100*Math.cos(b/100*Math.PI*2);y=200+100*Math.sin(b/100*Math.PI*2);context.save();context.globalCompositeOperation="lighter";glow_gradient=context.createRadialGradient(x,
y,0,x,y,30);glow_gradient.addColorStop(0,"rgba(255,255,255,.7)");glow_gradient.addColorStop(0.2,"rgba(180,245,255,.6)");glow_gradient.addColorStop(0.5,"rgba(180,245,255,.2)");glow_gradient.addColorStop(1,"rgba(64,64,64,0)");context.fillStyle=glow_gradient;context.beginPath();context.arc(x,y,400,0,Math.PI*2,!1);context.closePath();context.fill();context.restore();for(i=0;i<10;i++)h.newParticle(b/100*Math.PI*2);h.updateParticles();h.center_spin_frame--;if(h.center_spin_frame==15)h.center_spin_frame=
0;setTimeout(h.redraw(h.canvas,h.percent,h),20)}}}function progressBarParticle(d,b,h,k,e){this.x=d;this.y=b;this.xd=h;this.yd=k;this.alive=!0;this.age=e}
function progressBarNewParticle(d){x=200+100*Math.cos(d);y=200+100*Math.sin(d);for(i=0;i<this.particles.length;i++)if(this.particles[i].alive==!1){this.particles[i]=new progressBarParticle(x,y,(0.5-Math.random())*3,(0.5-Math.random())*3,10);return}this.particles[this.particles.length]=new progressBarParticle(x,y,(0.5-Math.random())*3,(0.5-Math.random())*3,10)}
function progressBarUpdateParticles(){context=this.canvas.getContext("2d");for(i=0;i<this.particles.length;i++)if(this.particles[i].alive){this.particles[i].x+=this.particles[i].xd;this.particles[i].y+=this.particles[i].yd;this.particles[i].age--;if(this.particles[i].age==0)this.particles[i].alive=!1;context.globalAlpha=this.particles[i].age/10;context.globalCompositeOperation="lighter";context.shadowColor="transparent";new_gradient=context.createRadialGradient(this.particles[i].x,this.particles[i].y,
0,this.particles[i].x,this.particles[i].y,3);new_gradient.addColorStop(0,"rgba(255,255,255,.7)");new_gradient.addColorStop(0.2,"rgba(180,245,255,.6)");new_gradient.addColorStop(0.5,"rgba(180,245,255,.2)");new_gradient.addColorStop(1,"rgba(64,64,64,0)");context.fillStyle=new_gradient;context.beginPath();context.arc(this.particles[i].x,this.particles[i].y,3,Math.PI*2,!1);context.fill()}}
function portfolioPiece(d,b,h,k,e,m,u,z){this.fullsize=new portfolioImage(this,d);this.thumbnail=e?new portfolioThumbnail(this,b,h,k,e,m,u,z):new portfolioThumbnail(this,b,h,k);this.image_title=k;this.is_loaded=!1}function portfolioImage(d,b){this.parent=d;this.url=b;this.image=new Image}
function portfolioThumbnail(d,b,h,k,e,m,u,z){this.parent=d;this.ie_url=b;this.ie_image=new Image;this.plain_url=h;this.image=new Image;this.title=k;this.drawOnCanvas=drawOnCanvas;if(e)this.topX=e,this.topY=m,this.width=u,this.height=z}DOMAIN_2="http://diekisdreamings-images.appspot.com/";var inner_glow_data;function getPortfolioManifest(d){var b=new XMLHttpRequest;b.open("GET",d,!1);b.send(null);if(b.status==200)return b.responseText}
function getImageData(d,b){window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(d,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async="false",xmlDoc.loadXML(d));image_data=[];for(i=0;i<xmlDoc.getElementsByTagName("image").length;i++){ie_thumbnail_url="portfolio/images/"+xmlDoc.getElementsByTagName("image")[i].getElementsByTagName("thumbnail")[0].getElementsByTagName("url")[0].childNodes[0].nodeValue;thumbnail_url=xmlDoc.getElementsByTagName("image")[i].getElementsByTagName("thumbnail")[0].getElementsByTagName("plain_url")[0].childNodes[0].nodeValue;
fullsize_url=xmlDoc.getElementsByTagName("image")[i].getElementsByTagName("fullsize")[0].getElementsByTagName("jpeg")[0].childNodes[0].nodeValue;if(b)fullsize_url=xmlDoc.getElementsByTagName("image")[i].getElementsByTagName("fullsize")[0].getElementsByTagName("webp")[0].childNodes[0].nodeValue;thumbnail_url=="=fullsize"&&(thumbnail_url=fullsize_url);image_title=xmlDoc.getElementsByTagName("image")[i].getElementsByTagName("image_title")[0].childNodes[0].nodeValue;(subset=xmlDoc.getElementsByTagName("image")[i].getElementsByTagName("thumbnail")[0].getElementsByTagName("subset")[0])?
(topX=parseInt(subset.getElementsByTagName("tlX")[0].childNodes[0].nodeValue),topY=parseInt(subset.getElementsByTagName("tlY")[0].childNodes[0].nodeValue),width=parseInt(subset.getElementsByTagName("brX")[0].childNodes[0].nodeValue)-topX,height=parseInt(subset.getElementsByTagName("brY")[0].childNodes[0].nodeValue)-topY,image_data[i]=new portfolioPiece(fullsize_url,ie_thumbnail_url,thumbnail_url,image_title,topX,topY,width,height)):image_data[i]=new portfolioPiece(fullsize_url,ie_thumbnail_url,thumbnail_url,
image_title)}return image_data}function loadPortfolio(d,b){manifest=getPortfolioManifest(d);portfolio_data=getImageData(manifest,b);for(i=0;i<portfolio_data.length;i++)portfolio_data[i].fullsize.image.src=DOMAIN_2+"images/"+portfolio_data[i].fullsize.url,portfolio_data[i].fullsize.image.onload=markImageLoaded(portfolio_data[i]);return portfolio_data}function markImageLoaded(d){return function(){d.fullsize.is_loaded=!0;if(d.thumbnail.is_loaded==!0)d.is_loaded=!0}}
function markThumbnailLoaded(d){return function(){d.thumbnail.is_loaded=!0;if(d.fullsize.is_loaded==!0)d.is_loaded=!0}}
function prerenderInnerGlow(){canvas=document.createElement("canvas");if(canvas.getContext)context=canvas.getContext("2d"),canvas.width=680,canvas.height=180,context.rectWithRoundRectHole(0,0,context.canvas.width,context.canvas.height,9.5,9.5,670.5,170.5,5),context.fillStyle="white",context.fill(),stackBlurCanvasRGBA(context.canvas,0,0,context.canvas.width,context.canvas.height,46),inner_glow_data=new Image,inner_glow_data.src=context.canvas.toDataURL("image/png")}
function drawOnCanvas(d,b){context=d.getContext("2d");i=this.image;i.src=DOMAIN_2+"images/"+this.plain_url;i.width==0?i.onload=constructPortfolioDisplay(this,context,b,i):(markThumbnailLoaded(this.parent),i_c=constructPortfolioDisplay(this,context,b,i),i_c())}
function constructPortfolioDisplay(d,b,h,k){return function(){b.canvas.width=680;b.canvas.height=180;markThumbnailLoaded(d.parent);image_offset_y=image_offset_x=0;image_scale=1;if(d.topX)image_offset_x=d.topX,image_offset_y=d.topY,image_scale=662/d.width;b.save();b.roundRect(9,9,671,171,5);b.fillStyle="black";b.shadowColor="black";b.shadowOffsetX=0;b.shadowOffsetY=0;b.shadowBlur=10;b.fill();b.restore();b.save();b.roundRect(9,9,671,171,5);b.fillStyle="#444";b.fill();b.save();b.clip();d.topX?b.drawImage(k,
image_offset_x,image_offset_y,d.width,d.height,9,59,662,112):b.drawImage(k,9,59);if(h==!0)b.save(),highlight_gradient=b.createRadialGradient(331,81,0,331,81,264.8),highlight_gradient.addColorStop(0,"rgba(128,128,255,.4)"),highlight_gradient.addColorStop(1,"rgba(255,255,255,0)"),b.roundRect(8.5,8.5,671.5,171.5,5),b.globalCompositeOperation="lighter",b.fillStyle=highlight_gradient,b.fill(),b.restore();text_box_gradient=b.createLinearGradient(0,9,0,54);text_box_gradient.addColorStop(0,"#333333");text_box_gradient.addColorStop(1,
"#333333");b.fillStyle=text_box_gradient;b.fillRect(9,9,662,54);box_shadow_gradient=b.createLinearGradient(0,61,0,70);box_shadow_gradient.addColorStop(0,"rgba(0,0,0,.6)");box_shadow_gradient.addColorStop(1,"transparent");b.fillStyle=box_shadow_gradient;b.fillRect(9,63,662,9);b.restore();b.save();b.textAlign="center";b.textBaseline="bottom";b.font="48px ChocolateBoxRegular";b.save();b.shadowColor="rgba(0,0,0,.68)";b.shadowOffsetX=2;b.shadowOffsetY=1;b.shadowBlur=4;b.fillText(d.title,340,69);b.restore();
text_gradient=b.createLinearGradient(0,15,0,60);text_gradient.addColorStop(0,"#f9f9f9");text_gradient.addColorStop(1,"#bebebe");b.fillStyle=text_gradient;b.fillText(d.title,340,69);b.restore();b.save();b.roundRect(9,9,671,171,5);b.clip();b.globalAlpha=0.18;b.drawImage(inner_glow_data,0,0);b.restore();b.save();b.roundRect(9.5,9.5,670.5,170.5,5);b.strokeStyle="#888";b.lineWidth=1;b.stroke();b.restore()}}
CanvasRenderingContext2D.prototype.roundRect=function(d,b,h,k,e){var m=Math.PI/180;h-d-2*e<0&&(e=(h-d)/2);k-b-2*e<0&&(e=(k-b)/2);this.beginPath();this.moveTo(d+e,b);this.lineTo(h-e,b);this.arc(h-e,b+e,e,m*270,m*360,!1);this.lineTo(h,k-e);this.arc(h-e,k-e,e,m*0,m*90,!1);this.lineTo(d+e,k);this.arc(d+e,k-e,e,m*90,m*180,!1);this.lineTo(d,b+e);this.arc(d+e,b+e,e,m*180,m*270,!1);this.closePath()};
CanvasRenderingContext2D.prototype.rectWithRoundRectHole=function(d,b,h,k,e,m,u,z,o){var E=Math.PI/180;h-d-2*o<0&&(o=(h-d)/2);k-b-2*o<0&&(o=(k-b)/2);this.beginPath();this.moveTo(e,m);this.lineTo(e,z);this.lineTo(u,z);this.lineTo(u,m);this.moveTo(d+o,b);this.lineTo(h-o,b);this.arc(h-o,b+o,o,E*270,E*360,!1);this.lineTo(h,k-o);this.arc(h-o,k-o,o,E*0,E*90,!1);this.lineTo(d+o,k);this.arc(d+o,k-o,o,E*90,E*180,!1);this.lineTo(d,b+o);this.arc(d+o,b+o,o,E*180,E*270,!1);this.closePath()};
var MAIN_PAGE=0,FANTASY_PAGE=1,SCIFI_PAGE=2,current_page=MAIN_PAGE,progress_bar;$(document).ready(init);$(window).bind("load",function(){displayImages();initLightbox()});function formatTitle(d){return'<div class="images-title">'+(d&&d.length?"<b>"+d+"</b>":"")+"</div>"}
function finishLoading(){$("#fantasy-link").click(function(){showFantasy()});$("#scifi-link").click(function(){showScifi()});$.History.bind("/fantasy",showFantasy);$.History.bind("/scifi",showScifi);$.History.bind("/main",showMain);$("#banner").delay(900).fadeIn();$("#fantasy-banner").delay(1E3).fadeIn();$("#scifi-banner").delay(1100).fadeIn()}var fantasy_data;global_webp_support=!1;function portfolioStageTwoLoad(d){global_webp_support=d;loadImages(d)}
function portfolioOnloadHandler(){var d=document.createElement("div");d.innerHTML='<img id = "test_image" src="data:image/webp,RIFF*%00%00%00WEBPVP8%20%1E%00%00%00%10%02%00%9D%01*%04%00%04%00%0B%C7%08%85%85%88%85%84%88%3F%82%00%0C%0D%60%00%FE%E6%B5%00">';webp_test=d.firstChild;d.firstChild.onerror=function(){portfolioStageTwoLoad(!1)};d.firstChild.onload=function(){portfolioStageTwoLoad(!0)};d=new Image;d.src="data:image/webp,RIFF*%00%00%00WEBPVP8%20%1E%00%00%00%10%02%00%9D%01*%04%00%04%00%0B%C7%08%85%85%88%85%84%88%3F%82%00%0C%0D%60%00%FE%E6%B5%00";
d.onerror=function(){portfolioStageTwoLoad(!1)};d.onload=function(){portfolioStageTwoLoad(!0)}}function init(){onloadHandler();portfolioOnloadHandler();startProgressBar()}function startProgressBar(){progress_bar=new progressBar(document.getElementById("progress-bar"));setTimeout(checkProgress,100)}
function checkProgress(){for(a=numloaded=0;a<fantasy_data.length;a++)fantasy_data[a].fullsize.is_loaded==!0&&numloaded++;for(a=0;a<scifi_data.length;a++)scifi_data[a].fullsize.is_loaded==!0&&numloaded++;for(a=0;a<canvases_loaded.length;a++)canvases_loaded[a]==!0&&numloaded++;progress=numloaded/(scifi_data.length+fantasy_data.length+canvases_loaded.length)*100;progress_bar.updateProgress(progress);progress==100?setTimeout(hideProgressBar,500):setTimeout(checkProgress,100)}
function hideProgressBar(){$("#progress-counter").delay(100).fadeOut(500);$("#loading-text").delay(100).fadeOut(500);finishLoading()}
function loadImages(d){fantasy_data=loadPortfolio("portfolio/images/fantasy.xml",d);fantasy_div=document.getElementById("fantasy-images");prerenderInnerGlow();var b=Array,h=[];for(n=0;n<fantasy_data.length;n++)if(Modernizr.canvas)b[n]=new Image,b[n].src=DOMAIN_2+"images/"+fantasy_data[n].thumbnail.plain_url,b[n].onload=markThumbnailLoaded(fantasy_data[n]);scifi_data=loadPortfolio("portfolio/images/sci-fi.xml",d);scifi_div=document.getElementById("scifi-images");for(n=0;n<scifi_data.length;n++)if(Modernizr.canvas)h[n]=
new Image,h[n].src=DOMAIN_2+"images/"+scifi_data[n].thumbnail.plain_url,h[n].onload=markThumbnailLoaded(scifi_data[n])}
function displayImages(){fantasy_data=loadPortfolio("portfolio/images/fantasy.xml",global_webp_support);fantasy_div=document.getElementById("fantasy-images");prerenderInnerGlow();for(n=0;n<fantasy_data.length;n++)a=document.createElement("a"),a.href=fantasy_data[n].fullsize.image.src,a.setAttribute("class","portfolio-image"),a.setAttribute("data-title",fantasy_data[n].image_title),Modernizr.canvas?(c=document.createElement("canvas"),c.setAttribute("class","portfolio-image"),c.setAttribute("onmouseover",
"fantasy_data["+n+"].thumbnail.drawOnCanvas(this, true);"),c.setAttribute("onmouseout","fantasy_data["+n+"].thumbnail.drawOnCanvas(this, false);"),a.appendChild(c),fantasy_data[n].thumbnail.drawOnCanvas(c)):(i=new Image,i.setAttribute("class","portfolio-image"),i.src=fantasy_data[n].thumbnail.ie_url,a.appendChild(i)),fantasy_div.appendChild(a);fantasy_credit_div=document.createElement("div");fantasy_credit_div.innerHTML="";fantasy_credit_div.setAttribute("class","credit");fantasy_div.appendChild(fantasy_credit_div);
scifi_data=loadPortfolio("portfolio/images/sci-fi.xml",global_webp_support);scifi_div=document.getElementById("scifi-images");for(n=0;n<scifi_data.length;n++)a=document.createElement("a"),a.href=scifi_data[n].fullsize.image.src,a.setAttribute("class","portfolio-image"),a.setAttribute("data-title",scifi_data[n].image_title),Modernizr.canvas?(c=document.createElement("canvas"),c.setAttribute("class","portfolio-image"),c.setAttribute("onmouseover","scifi_data["+n+"].thumbnail.drawOnCanvas(this, true);"),
c.setAttribute("onmouseout","scifi_data["+n+"].thumbnail.drawOnCanvas(this, false);"),a.appendChild(c),scifi_data[n].thumbnail.drawOnCanvas(c)):(i=new Image,i.setAttribute("class","portfolio-image"),i.src=scifi_data[n].thumbnail.ie_url,a.appendChild(i)),scifi_div.appendChild(a);scifi_credit_div=document.createElement("div");scifi_credit_div.innerHTML="Gun model by Patrick Sharkey. Gears by Obsidian Dawn.";scifi_credit_div.setAttribute("class","credit");scifi_div.appendChild(scifi_credit_div)}
function showFantasy(){current_page==MAIN_PAGE?($("#fantasy-banner").fadeOut(),$("#scifi-banner").fadeOut(),$("#fantasy-images").delay(500).fadeIn()):current_page==SCIFI_PAGE&&($("#scifi-image").fadeOut(),$("#fantasy-images").delay(500).fadeIn());current_page=FANTASY_PAGE}
function showScifi(){current_page==MAIN_PAGE?($("#fantasy-banner").fadeOut(),$("#scifi-banner").fadeOut(),$("#scifi-images").delay(500).fadeIn()):current_page==FANTASY_PAGE&&($("#fantasy-images").fadeOut(),$("#scifi-images").delay(500).fadeIn());current_page=SCIFI_PAGE}function showMain(){$("#fantasy-images").fadeOut();$("#scifi-images").fadeOut();$("#fantasy-banner").delay(500).fadeIn();$("#scifi-banner").delay(600).fadeIn();current_page=MAIN_PAGE}
window.Modernizr=function(d,b,h){function k(){z.input=function(b){for(var d=0,f=b.length;d<f;d++)F[b[d]]=!!(b[d]in v);return F}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" "));z.inputtypes=function(d){for(var D=0,e,g,j,k=d.length;D<k;D++)v.setAttribute("type",g=d[D]),(e=v.type!=="text")&&(v.value=f,v.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(g)&&v.style.WebkitAppearance!==h?(o.appendChild(v),j=b.defaultView,e=j.getComputedStyle&&
j.getComputedStyle(v,null).WebkitAppearance!=="textfield"&&v.offsetHeight!==0,o.removeChild(v)):/^(search|tel)$/.test(g)||(/^(url|email)$/.test(g)?e=v.checkValidity&&v.checkValidity()===!1:/^color$/.test(g)?(o.appendChild(v),e=v.value!=f,o.removeChild(v)):e=v.value!=f)),A[d[D]]=!!e;return A}("search tel url email datetime date month week time datetime-local number range color".split(" "))}function e(b,d){var e=b.charAt(0).toUpperCase()+b.substr(1),e=(b+" "+S.join(e+" ")+e).split(" ");return!!m(e,
d)}function m(b,d){for(var e in b)if(r[b[e]]!==h&&(!d||d(b[e],j)))return!0}function u(b,d){return typeof b===d}var z={},o=b.documentElement,E=b.head||b.getElementsByTagName("head")[0],j=b.createElement("modernizr"),r=j.style,v=b.createElement("input"),f=":)",p=Object.prototype.toString,l=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),S="Webkit Moz O ms Khtml".split(" "),w={svg:"http://www.w3.org/2000/svg"},g={},A={},F={},L=[],I,K=function(d){var e=b.createElement("style"),f=b.createElement("div");
e.textContent=d+"{#modernizr{height:3px}}";E.appendChild(e);f.id="modernizr";o.appendChild(f);d=f.offsetHeight===3;e.parentNode.removeChild(e);f.parentNode.removeChild(f);return!!d},J=function(){var d={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(e,f){var f=f||b.createElement(d[e]||"div"),g=(e="on"+e)in f;g||(f.setAttribute||(f=b.createElement("div")),f.setAttribute&&f.removeAttribute&&(f.setAttribute(e,""),g=u(f[e],"function"),u(f[e],
h)||(f[e]=h),f.removeAttribute(e)));return g}}(),H={}.hasOwnProperty,B;u(H,h)||u(H.call,h)?B=function(b,d){return d in b&&u(b.constructor.prototype[d],h)}:B=function(b,d){return H.call(b,d)};g.flexbox=function(){var d=b.createElement("div"),e=b.createElement("div");(function(b,d,e,f){d+=":";b.style.cssText=(d+l.join(e+";"+d)).slice(0,-d.length)+(f||"")})(d,"display","box","width:42px;padding:0;");e.style.cssText=l.join("box-flex:1;")+"width:10px;";d.appendChild(e);o.appendChild(d);var f=e.offsetWidth===
42;d.removeChild(e);o.removeChild(d);return f};g.canvas=function(){var d=b.createElement("canvas");return d.getContext&&d.getContext("2d")};g.canvastext=function(){return z.canvas&&u(b.createElement("canvas").getContext("2d").fillText,"function")};g.webgl=function(){return!!d.WebGLRenderingContext};g.touch=function(){return"ontouchstart"in d||K("@media ("+l.join("touch-enabled),(")+"modernizr)")};g.geolocation=function(){return!!navigator.geolocation};g.postmessage=function(){return!!d.postMessage};
g.websqldatabase=function(){return!!d.openDatabase};g.indexedDB=function(){for(var b=-1,e=S.length;++b<e;){var f=S[b].toLowerCase();if(d[f+"_indexedDB"]||d[f+"IndexedDB"])return!0}return!1};g.hashchange=function(){return J("hashchange",d)&&(b.documentMode===h||b.documentMode>7)};g.history=function(){return!(!d.history||!history.pushState)};g.draganddrop=function(){return J("dragstart")&&J("drop")};g.websockets=function(){return"WebSocket"in d};g.rgba=function(){r.cssText="background-color:rgba(150,255,150,.5)";
return(""+r.backgroundColor).indexOf("rgba")!==-1};g.hsla=function(){r.cssText="background-color:hsla(120,40%,100%,.5)";return(""+r.backgroundColor).indexOf("rgba")!==-1||(""+r.backgroundColor).indexOf("hsla")!==-1};g.multiplebgs=function(){r.cssText="background:url(//:),url(//:),red url(//:)";return/(url\s*\(.*?){3}/.test(r.background)};g.backgroundsize=function(){return e("backgroundSize")};g.borderimage=function(){return e("borderImage")};g.borderradius=function(){return e("borderRadius","",function(b){return(""+
b).indexOf("orderRadius")!==-1})};g.boxshadow=function(){return e("boxShadow")};g.textshadow=function(){return b.createElement("div").style.textShadow===""};g.opacity=function(){var b=l.join("opacity:.55;")+"";r.cssText=b;return/^0.55$/.test(r.opacity)};g.cssanimations=function(){return e("animationName")};g.csscolumns=function(){return e("columnCount")};g.cssgradients=function(){var b=("background-image:"+l.join("gradient(linear,left top,right bottom,from(#9f9),to(white));background-image:")+l.join("linear-gradient(left top,#9f9, white);background-image:")).slice(0,
-17);r.cssText=b;return(""+r.backgroundImage).indexOf("gradient")!==-1};g.cssreflections=function(){return e("boxReflect")};g.csstransforms=function(){return!!m(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"])};g.csstransforms3d=function(){var b=!!m(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]);b&&"webkitPerspective"in o.style&&(b=K("@media ("+l.join("transform-3d),(")+"modernizr)"));return b};g.csstransitions=function(){return e("transitionProperty")};
g.fontface=function(){var d,e,f=E||o,g=b.createElement("style");e=b.implementation||{hasFeature:function(){return!1}};g.type="text/css";f.insertBefore(g,f.firstChild);d=g.sheet||g.styleSheet;e=(e.hasFeature("CSS2","")?function(b){if(!d||!b)return!1;var e=!1;try{d.insertRule(b,0),e=/src/i.test(d.cssRules[0].cssText),d.deleteRule(d.cssRules.length-1)}catch(f){}return e}:function(b){if(!d||!b)return!1;d.cssText=b;return d.cssText.length!==0&&/src/i.test(d.cssText)&&d.cssText.replace(/\r+|\n+/g,"").indexOf(b.split(" ")[0])===
0})('@font-face { font-family: "font"; src: url(data:,); }');f.removeChild(g);return e};g.video=function(){var d=b.createElement("video"),e=!!d.canPlayType;if(e)e=new Boolean(e),e.ogg=d.canPlayType('video/ogg; codecs="theora"'),e.h264=d.canPlayType('video/mp4; codecs="avc1.42E01E"')||d.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'),e.webm=d.canPlayType('video/webm; codecs="vp8, vorbis"');return e};g.audio=function(){var d=b.createElement("audio"),e=!!d.canPlayType;e&&(e=new Boolean(e),
e.ogg=d.canPlayType('audio/ogg; codecs="vorbis"'),e.mp3=d.canPlayType("audio/mpeg;"),e.wav=d.canPlayType('audio/wav; codecs="1"'),e.m4a=d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/aac;"));return e};g.localstorage=function(){try{return!!localStorage.getItem}catch(b){return!1}};g.sessionstorage=function(){try{return!!sessionStorage.getItem}catch(b){return!1}};g.webWorkers=function(){return!!d.Worker};g.applicationcache=function(){return!!d.applicationCache};g.svg=function(){return!!b.createElementNS&&
!!b.createElementNS(w.svg,"svg").createSVGRect};g.inlinesvg=function(){var d=b.createElement("div");d.innerHTML="<svg/>";return(d.firstChild&&d.firstChild.namespaceURI)==w.svg};g.smil=function(){return!!b.createElementNS&&/SVG/.test(p.call(b.createElementNS(w.svg,"animate")))};g.svgclippaths=function(){return!!b.createElementNS&&/SVG/.test(p.call(b.createElementNS(w.svg,"clipPath")))};for(var C in g)B(g,C)&&(I=C.toLowerCase(),z[I]=g[C](),L.push((z[I]?"":"no-")+I));z.input||k();z.crosswindowmessaging=
z.postmessage;z.historymanagement=z.history;z.addTest=function(b,d){b=b.toLowerCase();if(!z[b])return d=!!d(),o.className+=" "+(d?"":"no-")+b,z[b]=d,z};r.cssText="";j=v=null;d.attachEvent&&function(){var d=b.createElement("div");d.innerHTML="<elem></elem>";return d.childNodes.length!==1}()&&function(b,d){function e(d,b){for(var f=-1,g=d.length,h,j=[];++f<g;)h=d[f],(b=h.media||b)!="screen"&&j.push(e(h.imports,b),h.cssText);return j.join("")}function f(d){for(var b=-1;++b<h;)d.createElement(g[b])}var g=
"abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video".split("|"),h=g.length,j=RegExp("(^|\\s)(abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video)","gi"),k=RegExp("<(/*)(abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video)","gi"),o=RegExp("(^|[^\\n]*?\\s)(abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video)([^\\n]*)({[\\n\\w\\W]*?})",
"gi"),m=d.createDocumentFragment(),p=d.documentElement,l=p.firstChild,r=d.createElement("body"),u=d.createElement("style"),v;f(d);f(m);l.insertBefore(u,l.firstChild);u.media="print";b.attachEvent("onbeforeprint",function(){var b=-1,f=e(d.styleSheets,"all"),l=[],q;for(v=v||d.body;(q=o.exec(f))!=null;)l.push((q[1]+q[2]+q[3]).replace(j,"$1.iepp_$2")+q[4]);for(u.styleSheet.cssText=l.join("\n");++b<h;){f=d.getElementsByTagName(g[b]);l=f.length;for(q=-1;++q<l;)f[q].className.indexOf("iepp_")<0&&(f[q].className+=
" iepp_"+g[b])}m.appendChild(v);p.appendChild(r);r.className=v.className;r.innerHTML=v.innerHTML.replace(k,"<$1font")});b.attachEvent("onafterprint",function(){r.innerHTML="";p.removeChild(r);p.appendChild(v);u.styleSheet.cssText=""})}(d,b);z._enableHTML5=!0;z._version="1.7";o.className=o.className.replace(/\bno-js\b/,"")+" js "+L.join(" ");return z}(this,this.document);
function initLightbox(){$("a.portfolio-image").click(function(d){canvas=document.createElement("canvas");canvas.getContext&&(d.preventDefault(),lightbox_image_title=this.getAttribute("data-title"),displayLightbox(this.href,this.getAttribute("data-title")),$("#lightbox-canvas").click(function(){hideLightbox()}))})}function hideLightbox(){$("#lightbox-canvas").fadeOut(400);setTimeout(function(){$("#lightbox-canvas").remove()},400)}
function displayLightbox(d,b){canvas=document.createElement("canvas");document.getElementById("body").appendChild(canvas);canvas.id="lightbox-canvas";canvas.width=$(window).width();canvas.height=$(window).height()+20;$("#lightbox-canvas").css("position","fixed");$("#lightbox-canvas").css("top","0px");$("#lightbox-canvas").css("left","0px");context=canvas.getContext("2d");context.fillStyle="rgba(0,0,0,.5)";context.fillRect(0,0,canvas.width,canvas.height);image=new Image;image.src=d;image.onload=drawLightboxImage(image,
b)}
function drawLightboxImage(d){return function(){canvas=document.getElementById("lightbox-canvas");context=canvas.getContext("2d");window_height=$(window).height();window_width=$(window).width();image_width=d.width;image_height=d.height;image_scale=1;image_height+110>window_height&&(image_scale=window_height/(image_height+110));image_width*image_scale+40>window_width&&(image_scale=window_width/(image_width+40));image_height*=image_scale;image_width*=image_scale;image_left_x=Math.floor(window_width/2-
image_width/2);image_top_y=Math.floor(window_height/2-(image_height-60)/2);image_right_x=image_left_x+image_width;image_bottom_y=image_top_y+image_height;glow_canvas=document.createElement("canvas");glow_context=glow_canvas.getContext("2d");glow_canvas.width=window_width;glow_canvas.height=window_height;glow_context.rectWithRoundRectHole(0,0,glow_context.canvas.width,glow_context.canvas.height,image_left_x,image_top_y-60,image_right_x,image_bottom_y,5);glow_context.fillStyle="white";glow_context.shadowColor=
"rgba(255,255,255,1);";glow_context.shadowBlur=46;glow_context.shadowOffsetX=0;glow_context.shadowOffsetY=0;glow_context.fill();var b=new Image;b.src=glow_context.canvas.toDataURL("image/png");b.onload=finishDrawingLightbox(canvas,b)}}
function finishDrawingLightbox(d,b){return function(){context=d.getContext("2d");context.save();context.shadowColor="black";context.shadowBlur=20;context.shadowOffsetX=2;context.shadowOffsetY=2;context.roundRect(image_left_x,image_top_y-60,image_right_x,image_bottom_y,5);context.fillStyle="#333";context.fill();context.restore();context.save();context.roundRect(image_left_x,image_top_y-60,image_right_x,image_bottom_y,5);context.clip();context.drawImage(image,image_left_x,image_top_y,image_width,image_height);
context.restore();context.save();box_shadow_gradient=context.createLinearGradient(0,image_top_y,0,image_top_y+9);box_shadow_gradient.addColorStop(0,"rgba(0,0,0,.6)");box_shadow_gradient.addColorStop(1,"transparent");context.fillStyle=box_shadow_gradient;context.fillRect(image_left_x,image_top_y,image_width,9);context.restore();context.save();context.globalCompositeOperation="lighter";context.roundRect(image_left_x,image_top_y-60,image_right_x,image_bottom_y+0.5,5);context.strokeStyle="#888";context.stroke();
context.restore();context.save();context.textAlign="center";context.textBaseline="bottom";context.font="48px ChocolateBoxRegular";context.save();context.shadowColor="rgba(0,0,0,.68)";context.shadowOffsetX=2;context.shadowOffsetY=1;context.shadowBlur=4;context.fillText(lightbox_image_title,window_width/2,image_top_y);context.restore();text_gradient=context.createLinearGradient(0,image_top_y-45,0,image_top_y);text_gradient.addColorStop(0,"#f9f9f9");text_gradient.addColorStop(1,"#bebebe");context.fillStyle=
text_gradient;context.fillText(lightbox_image_title,window_width/2,image_top_y);context.restore();context.save();context.roundRect(image_left_x,image_top_y-60,image_right_x,image_bottom_y,5);context.clip();context.globalAlpha=0.1;context.drawImage(b,0,0);context.restore()}}
CanvasRenderingContext2D.prototype.roundRect=function(d,b,h,k,e){var m=Math.PI/180;h-d-2*e<0&&(e=(h-d)/2);k-b-2*e<0&&(e=(k-b)/2);this.beginPath();this.moveTo(d+e,b);this.lineTo(h-e,b);this.arc(h-e,b+e,e,m*270,m*360,!1);this.lineTo(h,k-e);this.arc(h-e,k-e,e,m*0,m*90,!1);this.lineTo(d+e,k);this.arc(d+e,k-e,e,m*90,m*180,!1);this.lineTo(d,b+e);this.arc(d+e,b+e,e,m*180,m*270,!1);this.closePath()};
CanvasRenderingContext2D.prototype.rectWithRoundRectHole=function(d,b,h,k,e,m,u,z,o){var E=Math.PI/180;h-d-2*o<0&&(o=(h-d)/2);k-b-2*o<0&&(o=(k-b)/2);this.beginPath();this.moveTo(e,m);this.lineTo(e,z);this.lineTo(u,z);this.lineTo(u,m);this.moveTo(d+o,b);this.lineTo(h-o,b);this.arc(h-o,b+o,o,E*270,E*360,!1);this.lineTo(h,k-o);this.arc(h-o,k-o,o,E*0,E*90,!1);this.lineTo(d+o,k);this.arc(d+o,k-o,o,E*90,E*180,!1);this.lineTo(d,b+o);this.arc(d+o,b+o,o,E*180,E*270,!1);this.closePath()};